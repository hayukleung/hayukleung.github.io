<!DOCTYPE html>
<html>
<head>
    <title>SQLite七种临时文件</title>

    <meta charset="UTF-8"/>

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

    <meta name="HandheldFriendly" content="true"/>

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>

    <meta name="apple-mobile-web-app-capable" content="yes"/>

    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>

    <link href="../asset/gitbook/style.css" type="text/css" rel="stylesheet"/>
    <link href="../asset/gitbook/istyle.css" type="text/css" rel="stylesheet"/>

    <style type="text/css">
        
            span.md_line{margin-bottom:0.5em; display:block; line-height:1.89}
            .md_line br{ display: none;}
            
    </style>

    <script>
        var flowchat_options = {
            'x': 0, 'y': 0, 'line-width': 1, 'line-length': 50, 'text-margin': 10, 'font-size': 13,
            'font-color': '#3c3c3c', 'line-color': '#666666', 'element-color': '#666666', 'fill': 'transparent',
            'yes-text': 'yes', 'no-text': 'no', 'arrow-end': 'block', 'class': 'flowchart', 'scale': 1,
            'symbols': { 'start': {}, 'end': {}, 'condition': {}, 'inputoutput': {}, 'operation': {}, 'subroutine': {}}
        }
    </script>
    <script type="text/javascript" src="../asset/other/raphael-min.js"></script>
    <script type="text/javascript" src="../asset/other/flowchart.js"></script>
    <script type="text/javascript" src="../asset/other/echarts.min.js"></script>


</head>

<body>





<div data-basepath="/service/gitbook" class="book">
    <div class="book-summary">
        <ul class="summary">
            <li>
                <a href="../index.html">Blog</a>
            </li>
            <li class="divider"></li>
            
                
                
    
    <li data-level="1" class="chapter" data-path="readme.html">
        
        
        <a href="../readme.html" ><b>1</b> Markdown文字材料</a>
        
            
                    
                
        
    </li>

            
                
                
    
    <li data-level="2" class="chapter" data-path="_posts/index.html">
        
        
        <a href="#" ><b>2</b> _posts</a>
        
            
                    
                        <ul class="articles">
                            
                                
    
    <li data-level="2.1" class="chapter" data-path="_posts/C语言编译过程.html">
        
        
        <a href="../_posts/C语言编译过程.html" ><b>2.1</b> C语言编译过程</a>
        
    </li>

                            
                                
    
    <li data-level="2.2" class="chapter" data-path="_posts/Matlab作图：A律13折线.html">
        
        
        <a href="../_posts/Matlab作图：A律13折线.html" ><b>2.2</b> Matlab作图:A律13折线</a>
        
    </li>

                            
                                
    
    <li data-level="2.3" class="chapter active" data-path="_posts/SQLite七种临时文件.html">
        
        
        <a href="../_posts/SQLite七种临时文件.html" ><b>2.3</b> SQLite七种临时文件</a>
        
    </li>

                            
                                
    
    <li data-level="2.4" class="chapter" data-path="_posts/SQLite临时文件及其编译参数.html">
        
        
        <a href="../_posts/SQLite临时文件及其编译参数.html" ><b>2.4</b> SQLite临时文件及其编译参数</a>
        
    </li>

                            
                                
    
    <li data-level="2.5" class="chapter" data-path="_posts/SQLite编译指令PRAGMA.html">
        
        
        <a href="../_posts/SQLite编译指令PRAGMA.html" ><b>2.5</b> SQLite编译指令PRAGMA</a>
        
    </li>

                            
                                
    
    <li data-level="2.6" class="chapter" data-path="_posts/const-in-cpp.html">
        
        
        <a href="../_posts/const-in-cpp.html" ><b>2.6</b> const-in-cpp</a>
        
    </li>

                            
                                
    
    <li data-level="2.7" class="chapter" data-path="_posts/extern-c.html">
        
        
        <a href="../_posts/extern-c.html" ><b>2.7</b> extern-c</a>
        
    </li>

                            
                                
    
    <li data-level="2.8" class="chapter" data-path="_posts/hello-world.html">
        
        
        <a href="../_posts/hello-world.html" ><b>2.8</b> Hello World</a>
        
    </li>

                            
                                
    
    <li data-level="2.9" class="chapter" data-path="_posts/inline-in-cpp.html">
        
        
        <a href="../_posts/inline-in-cpp.html" ><b>2.9</b> inline-in-cpp</a>
        
    </li>

                            
                                
    
    <li data-level="2.10" class="chapter" data-path="_posts/resume.html">
        
        
        <a href="../_posts/resume.html" ><b>2.10</b> 个人简历</a>
        
    </li>

                            
                                
    
    <li data-level="2.11" class="chapter" data-path="_posts/segmentation-fault.html">
        
        
        <a href="../_posts/segmentation-fault.html" ><b>2.11</b> segmentation-fault</a>
        
    </li>

                            
                                
    
    <li data-level="2.12" class="chapter" data-path="_posts/symbol-lookup-error.html">
        
        
        <a href="../_posts/symbol-lookup-error.html" ><b>2.12</b> symbol-lookup-error</a>
        
    </li>

                            
                                
    
    <li data-level="2.13" class="chapter" data-path="_posts/test.html">
        
        
        <a href="../_posts/test.html" ><b>2.13</b> Test</a>
        
    </li>

                            
                                
    
    <li data-level="2.14" class="chapter" data-path="_posts/使用autotools制作makefile.html">
        
        
        <a href="../_posts/使用autotools制作makefile.html" ><b>2.14</b> 使用autotools制作makefile</a>
        
    </li>

                            
                                
    
    <li data-level="2.15" class="chapter" data-path="_posts/如何修改Linux系统日期与时间.html">
        
        
        <a href="../_posts/如何修改Linux系统日期与时间.html" ><b>2.15</b> 如何修改Linux系统日期与时间</a>
        
    </li>

                            
                                
    
    <li data-level="2.16" class="chapter" data-path="_posts/文本相似度算法.html">
        
        
        <a href="../_posts/文本相似度算法.html" ><b>2.16</b> 文本相似度算法</a>
        
    </li>

                            
                                
    
    <li data-level="2.17" class="chapter" data-path="_posts/标准C的四个常用宏定义.html">
        
        
        <a href="../_posts/标准C的四个常用宏定义.html" ><b>2.17</b> 标准C的四个常用宏定义</a>
        
    </li>

                            
                                
    
    <li data-level="2.18" class="chapter" data-path="_posts/模拟频率、数字频率与模拟角频率.html">
        
        
        <a href="../_posts/模拟频率、数字频率与模拟角频率.html" ><b>2.18</b> 模拟频率、数字频率与模拟角频率</a>
        
    </li>

                            
                        </ul>
                    
                
        
    </li>

            
        </ul>

    </div>

    <div class="book-body">
        <div class="body-inner">

            <div class="book-header" role="navigation">
                <h1>
                    <a href="../index.html" > Blog</a>
                </h1>
            </div>

            <div tabindex="-1" class="page-wrapper">
                <div class="page-inner">
                    <h2 class="post_title"> SQLite七种临时文件 </h2>
                    <div class="post_body"> <p class="md_block">
    <span class="md_line md_line_dom_embed"><a class="md_compiled" href="http://www.cnblogs.com/liangxiaxu/archive/2013/02/08/2909236.html">原文链接</a></span>
</p>


<h2 id="toc_0">1.Rollback Journals</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">出现在事务的起始点，消失在事务的结束点<br /></span>
    <span class="md_line">若PRAGMA locking_mode=EXCLUSIVE; // 默认为normal<br /></span>
    <span class="md_line">则不会在事务结束点删除回滚日志<br /></span>
    <span class="md_line">若pragma journal_mode=persist; // 默认为delete<br /></span>
    <span class="md_line">也不会在事务结束点删除回滚日志<br /></span>
    <span class="md_line">若pragma journal_mode=off;<br /></span>
    <span class="md_line">则不会产生回滚日志<br /></span>
    <span class="md_line">存储于磁盘上</span>
</p>

</blockquote>
<!--more-->
<a name="more"></a>

<h2 id="toc_1">2.Master Journal Files</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">在一个数据库连接使用attach命令接入N个外部数据库的情况下，事务开始点产生的回滚日志<br /></span>
    <span class="md_line">存储于磁盘上</span>
</p>

</blockquote>

<h2 id="toc_2">3.Statement Journal Files</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">针对单个SQL语句的回滚日志<br /></span>
    <span class="md_line">存储于磁盘上</span>
</p>

</blockquote>

<h2 id="toc_3">4.Temp Databases</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">使用PRAGMA synchronous=OFF<br /></span>
    <span class="md_line">使用PRAGMA journal_mode=PERSIST<br /></span>
    <span class="md_line">操作速度较快，一般用于临时日志的记录操作</span>
</p>

</blockquote>

<h2 id="toc_4">5.Materializations Of Views And Subqueries</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">存储视图、子查询等临时表</span>
</p>

</blockquote>

<h2 id="toc_5">6.Transient Indices</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">瞬时索引，比如<br /></span>
    <span class="md_line">ORDER BY从句<br /></span>
    <span class="md_line">GROUP BY从句<br /></span>
    <span class="md_line">DISTINCT聚合查询关键词<br /></span>
    <span class="md_line">复合SELECT从句joined by UNION, EXCEPT或INTERSECT</span>
</p>

</blockquote>

<h2 id="toc_6">7.Transient Database Used By VACUUM</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">使用VACUUM压缩数据库文件时使用的临时文件</span>
</p>

</blockquote>

<h2 id="toc_7">总结</h2>

<ul>
<li>Temp Databases</li>
<li>Materializations Of Views And Subqueries</li>
<li>Transient Indices</li>
<li>Transient Database Used By VACUUM</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">这四类临时文件的存储位置受pragma temp_store和SQLITE_TEMP_STORE影响，如下表所示：</span>
</p>

</blockquote>

<h3 id="toc_8">表一</h3>

<p class="md_block">
    <span class="md_line">|名称|解释|存储位置|<br /></span>
    <span class="md_line">|:----------------------|:---------------------|:-|<br /></span>
    <span class="md_line">|Rollback Journals|回滚日志<br/>存在于事务的始末|始终存储于磁盘上<br/>这三类文件只是出现的场合不一样<br/>而本质是一样的<br/>可以总结为事务的回滚日志文件命名为’dbname.db-journal’|<br /></span>
    <span class="md_line">|Master Journal Files|主数据库日志，连接外部数据库时出现|同上|<br /></span>
    <span class="md_line">|Statement Journal Files|出现在单条SQL语句的事务始末|同上|<br /></span>
    <span class="md_line">|Temp Databases|用于存储临时表（temp table）|见表2|<br /></span>
    <span class="md_line">|Materializations Of Views And Subqueries|用于存储视图、子查询等临时表|同上|<br /></span>
    <span class="md_line">|Transient Indices|用于存储order by、group by等临时索引|同上|<br /></span>
    <span class="md_line">|Transient Database Used By VACUUM|Vacuum命令临时文件|同上|</span>
</p>


<h3 id="toc_9">表二</h3>

<p class="md_block">
    <span class="md_line">|注：<br/>即使将它们的位置设置为磁盘<br/>SQLite也会将它们存储在内存页中<br/>直到内存页满才写进磁盘<br/>而这个内存页大小由<br/>SQLITE_DEFAULT_TEMP_CACHE_SIZE决定<br/>默认是500页||||<br /></span>
    <span class="md_line">|:----------------|:---------|:-|:-|<br /></span>
    <span class="md_line">|pragma temp_store|0(default)|1 |2 |<br /></span>
    <span class="md_line">|SQLITE_TEMP_STORE|0(default)|1 |2 |<br /></span>
    <span class="md_line">|0                |磁盘|磁盘|磁盘|<br /></span>
    <span class="md_line">|1(default)       |磁盘|磁盘|内存|<br /></span>
    <span class="md_line">|2                |内存|磁盘|内存|<br /></span>
    <span class="md_line">|3                |内存|内存|内存|</span>
</p> </div>
                </div>
            </div>

        </div>

    </div>

</div>


<script type="text/javascript" src="../asset/gitbook/app.js"></script>

<script>require(["gitbook"], function (gitbook) {
    var config = {"fontSettings": {"theme": null, "family": "sans", "size": 2}};
    gitbook.start(config);
});

</script>





</body>

</html>